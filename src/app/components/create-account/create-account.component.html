<div class="row w-100 h-100" id="create-account-container">
    <!-- Left panel -->
    <div class="col-12 col-sm-12 col-lg-7 h-100 escomio-flex-center">
        <div class="container col-11 col-sm-11 col-md-7 pt-5 pb-5">

            <!-- Titles -->
            <span class="h1 d-block mb-3 escomio-txt-oxford-blue">Registro de cuenta</span>
            <span class="h5 d-block escomio-txt-rich-black">¡Crea una cuenta con nosotros!</span>

            <form
                [formGroup]="createAccountForm"
                class="mt-5"
            >
                <!-- Username -->
                <div class="mb-4">
                    <label for="username-input" class="form-label">Nombre de usuario</label>
                    <input
                        formControlName="username"
                        [ngClass]="{'is-invalid': username?.invalid && username?.touched }"
                        type="text" 
                        class="form-control" 
                        id="username-input"
                    >
                    <div *ngIf="username?.invalid && username?.touched" class="invalid-feedback">
                        <div *ngIf="username?.errors?.['required']">
                            Ingresa el nombre de usuario
                        </div>
                        <div *ngIf="username?.errors?.['minlength'] || username?.errors?.['maxlength']">
                            El nombre de usuario debe tener de 8 a 15 caracteres
                        </div>
                        <div *ngIf="username?.errors?.['pattern']">
                            Formato inválido (solo números, letras y '_')
                        </div>
                    </div>
                </div>

                <!-- ESCOM Id -->
                <div class="mb-4">
                    <label for="escomid-input" class="form-label">Número de boleta</label>
                    <input
                        formControlName="escomId"
                        [ngClass]="{ 'is-invalid': escomId?.invalid && escomId?.touched }"
                        pattern="[0-9]*" 
                        type="text" 
                        class="form-control" 
                        id="escomid-input"
                    >
                    <div *ngIf="escomId?.invalid && escomId?.touched" class="invalid-feedback">
                        <div *ngIf="escomId?.errors?.['required']">
                            Ingresa el número de boleta
                        </div>
                        <div *ngIf="escomId?.errors?.['minlength'] || escomId?.errors?.['maxlength']">
                            El número de boleta de 8 a 15 caractéres
                        </div>
                        <div *ngIf="escomId?.errors?.['pattern']">
                            Formáto inválido (solo números)
                        </div>
                    </div>
                </div>

                <!-- Email -->
                <div class="mb-4">
                    <label for="email-input" class="form-label">Correo electrónico</label>
                    <input
                        formControlName="email"
                        [ngClass]="{ 'is-invalid': email?.invalid && email?.touched }"
                        type="email" 
                        class="form-control" 
                        id="email-input"
                    >
                    <div *ngIf="email?.invalid && email?.touched" class="invalid-feedback">
                        <div *ngIf="email?.errors?.['required']">
                            Ingresa el correo electrónico
                        </div>
                        <div *ngIf="email?.errors?.['pattern']">
                            Formato inválido
                        </div>
                    </div>
                </div>

                <!-- Password -->
                <div class="mb-2">
                    <label for="password-input" class="form-label">Contraseña</label>
                    <input 
                        formControlName="password" 
                        [ngClass]="{ 'is-invalid': password?.invalid && password?.touched }"
                        [type]="passwordFieldType" 
                        class="form-control" 
                        id="password-input" 
                    />
                    <div *ngIf="password?.invalid && password?.touched" class="invalid-feedback">
                        <div *ngIf="password?.errors?.['required']">
                            Ingresa la contraseña
                        </div>
                        <div *ngIf="password?.errors?.['minlength']">
                            La contraseña debe de tener al menos 8 caractéres
                        </div>
                    </div>
                </div>

                <!-- Show password -->
                <div class="mb-4 form-check">
                    <input
                        (change)="togglePassword()"
                        type="checkbox" 
                        class="form-check-input" 
                        id="show-password-checkbox" 
                    />
                    <label class="form-check-label" for="show-password-checkbox">Mostrar contraseña</label>
                </div>
            
                <!-- Action button -->
                <button 
                    *ngIf="!isLoading" 
                    (click)="createAccount()" 
                    type="submit"
                    class="btn col-12 col-sm-12 escomio-bg-saphire-blue escomio-txt-snow">
                    Crear cuenta
                </button>

                <!-- Spinner -->
                <div *ngIf="isLoading" class="d-flex justify-content-center">
                    <div class="spinner-border escomio-txt-oxford-blue" role="status">
                        <span class="visually-hidden">Cargando...</span>
                    </div>
                </div>
            </form>

                <!-- Login Link -->
                <div class="mt-3 text-center">
                    <p> 
                        ¿Ya tienes cuenta?
                        <a
                        [routerLink]="['/', loginRoute]"
                        class="escomio-txt-cyan-process escomio-link">
                            Inicia sesión
                        </a>
                    </p>
                </div>

                <!-- Alert -->
                <div 
                    *ngIf="hasAlert" 
                    class="alert alert-danger d-flex align-items-center mt-4" 
                    role="alert"
                >
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    <div>
                        {{ responseMessage}}
                    </div>
                </div>
        </div>
    </div>
    
    <!-- Right panel with logo -->
    <div class="d-none d-sm-none d-lg-flex col-lg-5 h-100 escomio-flex-center">
        <app-logo-panel 
            logoSrc="../../../assets/images/icons/escomio-light-logo.png">
        </app-logo-panel>
    </div>  
</div>